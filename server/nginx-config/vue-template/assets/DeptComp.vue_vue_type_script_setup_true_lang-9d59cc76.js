/* empty css             */import{E as P,a as J,v as L}from"./el-form-item-b11b2e63.js";import{E as M}from"./el-overlay-019d04bc.js";import{E as z,a as j,b as K,c as R}from"./el-table-column-d67fdcea.js";import{P as W}from"./ServerResultInfo-97d8ba58.js";import{D as v}from"./Dept-1aa048dc.js";import{h as X,ac as G,S as H,aw as C,A as s,K as O,L as r,X as o,C as l,W as p,B as c,V as d,x as q,J as I,N as Q,T as Y,at as k,E as Z,aa as h}from"./index-28d2205f.js";import{T as b}from"./Tools-bd95c3f8.js";import{P as ee}from"./PageComp-f8d068d7.js";const me=X({__name:"DeptComp",props:{mode:{type:String,required:!1,default:"manage"}},emits:["dept-selected"],setup(g,{emit:D}){const B=g;function T(t){D("dept-selected",b.concatJson(t))}const e=G({page:new W,list:new Array,queryInfo:{deptName:""},modifyInfo:new v,mvisible:!1,modifying:!1,querying:!1,avisible:!1,addInfo:new v,adding:!1});H(()=>{B.mode=="selector"&&(e.page.pageSize=5),y()});function y(){e.querying=!0,C.post("/manage/dept/queryAll",b.concatJson(e.queryInfo,e.page),t=>{e.querying=!1,t.success&&(e.page=t.page,e.list=t.list)})}function w(){e.page.pageNumber=1,y()}function x(t){e.modifyInfo=t,e.mvisible=!0}function U(){e.modifying=!0,C.post("/manage/dept/update",e.modifyInfo,t=>{e.modifying=!1,t.success&&(e.addInfo=new v,k.alert(t.message,"部门修改"))})}function $(t){k.confirm(`是否删除部门：${t.deptName}？`,"删除确认",{type:"warning"}).then(()=>{const a=z.service({lock:!0,text:"部门删除中，请稍候。。。"});C.post("/manage/dept/delete",t,u=>{a.close(),k.alert(u.message,"删除结果"),u.success&&y()},!0)}).catch(()=>{})}function S(){e.addInfo=new v,e.avisible=!0}function A(){e.adding=!0,C.post("/manage/dept/add",e.addInfo,t=>{e.adding=!1,t.success&&(e.addInfo=new v,k.alert(t.message,"部门添加"))})}return(t,a)=>{const u=Z,m=P,i=h,E=J,V=j,F=K,_=M,f=L;return s(),O(Y,null,[r("div",null,[o(q(R),{justify:"end",class:"pd10"},{default:l(()=>[o(E,{inline:!0},{default:l(()=>[o(m,null,{default:l(()=>[p(o(u,{placeholder:"部门名称模糊查询",modelValue:e.queryInfo.deptName,"onUpdate:modelValue":a[0]||(a[0]=n=>e.queryInfo.deptName=n)},null,8,["modelValue"]),[[f,e.querying]])]),_:1}),o(m,null,{default:l(()=>[p((s(),c(i,{onClick:a[1]||(a[1]=n=>w()),type:"primary"},{default:l(()=>[d("查询")]),_:1})),[[f,e.querying]])]),_:1}),o(m,null,{default:l(()=>[o(i,{type:"success",onClick:S},{default:l(()=>[d("添加")]),_:1})]),_:1})]),_:1})]),_:1})]),r("div",null,[p((s(),c(F,{data:e.list},{default:l(()=>[o(V,{prop:"deptName",label:"部门名称"}),g.mode=="manage"?(s(),c(V,{key:0,prop:"deptInfo",label:"部门描述"})):I("",!0),g.mode=="manage"?(s(),c(V,{key:1,label:"信息最后修改时间"},{default:l(n=>[d(Q(q(b).formatDate(n.row.lastupdate)),1)]),_:1})):I("",!0),o(V,{label:"操作"},{default:l(n=>[g.mode=="manage"?(s(),c(i,{key:0,onClick:N=>x(n.row),type:"primary"},{default:l(()=>[d("修改")]),_:2},1032,["onClick"])):I("",!0),g.mode=="manage"?(s(),c(i,{key:1,onClick:N=>$(n.row),type:"danger"},{default:l(()=>[d("删除")]),_:2},1032,["onClick"])):I("",!0),g.mode=="selector"?(s(),c(i,{key:2,onClick:N=>T(n.row),type:"success"},{default:l(()=>[d("选择")]),_:2},1032,["onClick"])):I("",!0)]),_:1})]),_:1},8,["data"])),[[f,e.querying]]),r("div",null,[o(ee,{page:e.page,onNumberChange:y,onSizeChange:w},null,8,["page"])])]),r("div",null,[o(_,{modelValue:e.avisible,"onUpdate:modelValue":a[5]||(a[5]=n=>e.avisible=n),title:"添加部门信息","close-on-click-modal":!1,onClosed:y,width:"30%"},{footer:l(()=>[o(i,{type:"danger",onClick:a[4]||(a[4]=n=>e.avisible=!1)},{default:l(()=>[d("关闭")]),_:1}),o(i,{type:"success",onClick:A},{default:l(()=>[d("添加")]),_:1})]),default:l(()=>[r("div",null,[o(E,null,{default:l(()=>[o(m,null,{default:l(()=>[p(o(u,{placeholder:"部门名称",modelValue:e.addInfo.deptName,"onUpdate:modelValue":a[2]||(a[2]=n=>e.addInfo.deptName=n)},null,8,["modelValue"]),[[f,e.adding]])]),_:1}),o(m,null,{default:l(()=>[p(o(u,{placeholder:"部门描述",modelValue:e.addInfo.deptInfo,"onUpdate:modelValue":a[3]||(a[3]=n=>e.addInfo.deptInfo=n)},null,8,["modelValue"]),[[f,e.adding]])]),_:1})]),_:1})])]),_:1},8,["modelValue"])]),r("div",null,[o(_,{modelValue:e.mvisible,"onUpdate:modelValue":a[9]||(a[9]=n=>e.mvisible=n),title:"修改部门信息","close-on-click-modal":!1,onClosed:y},{footer:l(()=>[o(i,{type:"danger",onClick:a[8]||(a[8]=n=>e.mvisible=!1)},{default:l(()=>[d("关闭")]),_:1}),o(i,{type:"success",onClick:U},{default:l(()=>[d("保存")]),_:1})]),default:l(()=>[r("div",null,[o(E,null,{default:l(()=>[o(m,null,{default:l(()=>[p(o(u,{placeholder:"部门名称",modelValue:e.modifyInfo.deptName,"onUpdate:modelValue":a[6]||(a[6]=n=>e.modifyInfo.deptName=n)},null,8,["modelValue"]),[[f,e.modifying]])]),_:1}),o(m,null,{default:l(()=>[p(o(u,{placeholder:"部门描述",modelValue:e.modifyInfo.deptInfo,"onUpdate:modelValue":a[7]||(a[7]=n=>e.modifyInfo.deptInfo=n)},null,8,["modelValue"]),[[f,e.modifying]])]),_:1})]),_:1})])]),_:1},8,["modelValue"])])],64)}}});export{me as _};
